function h(e,t,i,s,r,a,l,m){var n=typeof e=="function"?e.options:e;t&&(n.render=t,n.staticRenderFns=i,n._compiled=!0),s&&(n.functional=!0),a&&(n._scopeId="data-v-"+a);var d;if(l?(d=function(o){o=o||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!o&&typeof __VUE_SSR_CONTEXT__<"u"&&(o=__VUE_SSR_CONTEXT__),r&&r.call(this,o),o&&o._registeredComponents&&o._registeredComponents.add(l)},n._ssrRegister=d):r&&(d=m?function(){r.call(this,(n.functional?this.parent:this).$root.$options.shadowRoot)}:r),d)if(n.functional){n._injectStyles=d;var p=n.render;n.render=function(v,c){return d.call(c),p(v,c)}}else{var u=n.beforeCreate;n.beforeCreate=u?[].concat(u,d):[d]}return{exports:e,options:n}}const _={mixins:[Fieldtype],inject:["storeName"],data(){return{loading:!0,selected:null,items:[],skipNextSeek:!1}},computed:{sourceUrl(){return this.store.values[this.config.source]},store(){return this.$store.state.publish[this.storeName]},duration(){return Math.round(this.$refs.video.duration*1e3)},selectedIndex(){return this.items.findIndex(e=>e.id===this.selected)},selectedItem(){return this.items[this.selectedIndex]},wrapperStyle(){return this.loading?{}:{"--video-aspect-ratio":this.$refs.video.videoWidth/this.$refs.video.videoHeight}}},methods:{loadedVideo(){this.loading=!1,this.items=this.value,this.items.length&&(this.selectItem(this.items[0]),this.syncItems())},seekedVideo(e){if(!this.selectedItem)return;if(this.skipNextSeek){this.skipNextSeek=!1;return}const t=e.target.currentTime*1e3,i=this.items.find(s=>s.start<=t&&s.end>=t);i&&this.selectItem(i,!1)},addItem(){var s;const e=this.$refs.video.currentTime*1e3,i={start:((s=this.selectedItem)==null?void 0:s.start)===e?this.selectedItem.start+(this.selectedItem.end-this.selectedItem.start)/2:e,end:null,text:null,id:uniqid()};this.items=[...this.items,i],this.syncItems(),this.selectItem(i)},seekVideo(e){this.skipNextSeek=!0,this.$refs.video.pause(),this.$refs.video.currentTime=e/1e3},updateItemStart(e){this.selectedItem&&(this.updateItem({start:e}),this.seekVideo(e))},updateItem(e){this.items=[...this.items.slice(0,this.selectedIndex),{...this.items[this.selectedIndex],...e},...this.items.slice(this.selectedIndex+1)],this.syncItems()},deleteThumbnail(){this.updateItem({thumbnail:null})},deleteItem(){this.items=[...this.items.slice(0,this.selectedIndex),...this.items.slice(this.selectedIndex+1)],this.syncItems(),this.items.length?this.selectItem(this.items[0]):this.deselectItem()},selectItem(e,t=!0){this.selected=e.id,t&&this.seekVideo(this.selectedItem.start)},deselectItem(){this.selected=null},syncItems(){this.items=this.items.sort((e,t)=>e.start-t.start).map((e,t)=>(t===0&&(e={...e,start:0}),t===this.items.length-1?e={...e,end:this.duration}:e={...e,end:this.items[t+1].start},e))},timecode(e){const t=Math.round(e/1e3),i=Math.floor(t/60),s=t%60;return`${i.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`},captureThumbnail(){const e=document.createElement("canvas"),t=e.getContext("2d");e.width=this.$refs.video.videoWidth,e.height=this.$refs.video.videoHeight,t.drawImage(this.$refs.video,0,0,e.width,e.height);const i=e.toDataURL("image/jpeg");e.remove(),this.updateItem({thumbnail:i})},itemThumbnail(e){var t;return(t=e.thumbnail)!=null&&t.startsWith("data:")?e.thumbnail:e.thumbnail&&this.meta.thumbnails[e.id]?this.meta.thumbnails[e.id]:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"}},watch:{items(e){this.updateDebounced(e)}}};var f=function(){var t=this,i=t._self._c;return i("div",{staticClass:"video_addon-wrapper",style:t.wrapperStyle},[i("video",{ref:"video",staticClass:"video_addon-preview w-full rounded-t bg-black",attrs:{src:t.sourceUrl,crossorigin:"anonymous",controls:""},on:{loadeddata:t.loadedVideo,seeked:t.seekedVideo}}),t.loading?t._e():i("div",{staticClass:"flex bg-gray-900 p-2 gap-2 rounded-b -mt-px text-white items-center"},[i("div",{staticClass:"video_addon-track video_text-track"},[t.selectedItem?i("input",{staticClass:"w-full",attrs:{D:"",type:"range",min:0,max:t.duration},domProps:{value:t.selectedItem.start},on:{input:function(s){return t.seekVideo(s.target.value)},change:function(s){return t.updateItemStart(s.target.value)}}}):t._e(),i("div",{staticClass:"video_text-chapters"},t._l(t.items,function(s){return i("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:s.text||"Unnamed",expression:"item.text || 'Unnamed'"}],style:{"--start":s.start/t.duration,"--end":s.end/t.duration},on:{click:function(r){return t.selectItem(s)}}})}),0)])]),t.loading?t._e():i("div",[t._l(t.items,function(s,r){return i("div",{staticClass:"mt-2 cursor-pointer relative video_text-item",class:{"video_text-selected":s.id===t.selected,"video_text-basic":t.config.mode==="basic","video_text-advanced":t.config.mode==="advanced"},on:{click:function(a){return t.selectItem(s)}}},[i("div",{staticClass:"video_text-item-timecode"},[t._v(" "+t._s(t.timecode(s.start))+" ")]),i("div",{staticClass:"video_text-item-thumbnail"},[i("img",{attrs:{src:t.itemThumbnail(s)}}),t.selectedIndex===r?[t.meta.id?t._e():i("div",{staticClass:"text-gray-600"},[t._v(" "+t._s(t.__("statamic::fieldtypes.assets.dynamic_folder_pending_save"))+" ")]),t.meta.id&&s.thumbnail?i("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.__("Remove Thumbnail"),expression:"__('Remove Thumbnail')"}],staticClass:"text-gray-600 cursor-pointer px-2 hover:text-blue-500",attrs:{type:"button"},on:{click:function(a){return a.stopPropagation(),t.deleteThumbnail()}}},[i("span",[t._v("×")])]):t._e()]:t._e()],2),i("div",{staticClass:"video_text-item-input"},[i("text-input",{staticClass:"video_text-item-text",attrs:{placeholder:"Text",value:s.text},on:{focus:function(a){return t.selectItem(s)},input:function(a){return t.updateItem({text:a})}}}),i("textarea-input",{staticClass:"video_text-item-description",attrs:{placeholder:"Description",value:s.description},on:{focus:function(a){return t.selectItem(s)},input:function(a){return t.updateItem({description:a})}}}),t.selectedIndex===r?i("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.__("Remove Chapter"),expression:"__('Remove Chapter')"}],staticClass:"text-gray-600 cursor-pointer px-2 hover:text-blue-500",attrs:{type:"button"},on:{click:function(a){return a.stopPropagation(),t.deleteItem()}}},[i("span",[t._v("×")])]):t._e()],1),i("div",{staticClass:"video_text-item-timecode",attrs:{hidden:""}},[t._v(" "+t._s(t.timecode(s.end))+" ")])])}),i("button",{staticClass:"btn mt-2",attrs:{type:"button"},on:{click:t.addItem}},[t._v("Add Chapter")]),t.meta.id?i("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.__("Capture Thumbnail"),expression:"__('Capture Thumbnail')"}],staticClass:"btn video_text-capture",attrs:{type:"button"},on:{click:function(s){return t.captureThumbnail()}}},[i("svg",{staticClass:"w-6 h-6 text-gray-600 cursor-pointer hover:text-blue-500",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"}},[i("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"}}),i("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"}})])]):t._e()],2)])},g=[],x=h(_,f,g,!1,null,null,null,null);const I=x.exports,b={mixins:[Fieldtype],inject:["storeName"],data(){return{loading:!0,item:null}},computed:{sourceUrl(){return this.config.source_url||this.store.values[this.config.source]},store(){return this.$store.state.publish[this.storeName]},duration(){return Math.round(this.$refs.video.duration*1e3)},isSingle(){return this.config.mode==="single"},isRange(){return this.config.mode==="range"},wrapperStyle(){return this.loading?{}:{"--video-aspect-ratio":this.$refs.video.videoWidth/this.$refs.video.videoHeight}}},methods:{loadedVideo(){this.loading=!1,this.item=this.value.start!==null||this.value.end!==null?this.value:{start:0,end:this.duration}},seekVideo(e){this.$refs.video.pause(),this.$refs.video.currentTime=e/1e3},updateTime(e,t){let i;if(this.isRange){const s=e==="start"?0:this.item.start,r=e==="start"?this.item.end:this.duration;i=Math.min(r,Math.max(s,parseInt(t)))}else i=parseInt(t);this.updateItem({[e]:i}),this.seekVideo(i)},updateItem(e){this.item={...this.item,...e},this.updateValue()},updateValue(){this.updateDebounced(this.config.null_limits?{start:this.item.start>0?this.item.start:null,end:this.item.end<this.duration?this.item.end:null}:this.item)},timecode(e){const t=Math.round(e/1e3),i=Math.floor(t/60),s=t%60;return`${i.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`}}};var C=function(){var t=this,i=t._self._c;return i("div",{staticClass:"video_addon-wrapper",style:t.wrapperStyle},[i("video",{ref:"video",staticClass:"video_addon-preview w-full rounded-t bg-black",attrs:{src:t.sourceUrl,controls:""},on:{loadeddata:t.loadedVideo}}),t.loading?t._e():i("div",{staticClass:"flex bg-gray-900 p-2 gap-2 rounded-b -mt-px text-white items-center"},[i("div",{staticClass:"w-12 shrink-0 text-center text-xs"},[t._v(" "+t._s(t.timecode(t.item.start))+" ")]),i("div",{staticClass:"video_addon-track video_time-track"},[i("input",{staticClass:"w-full",attrs:{type:"range",min:0,max:t.duration},domProps:{value:t.item.start},on:{input:function(s){return t.updateTime("start",s.target.value)}}}),t.isRange?i("div",{style:{"--start":t.item.start/t.duration,"--end":t.item.end/t.duration}}):t._e(),t.isRange?i("input",{staticClass:"w-full",attrs:{type:"range",min:0,max:t.duration},domProps:{value:t.item.end},on:{input:function(s){return t.updateTime("end",s.target.value)}}}):t._e()]),t.isRange?i("div",{staticClass:"w-12 shrink-0 text-center text-xs"},[t._v(" "+t._s(t.timecode(t.item.end))+" ")]):t._e()])])},k=[],$=h(b,C,k,!1,null,null,null,null);const w=$.exports;Statamic.booting(()=>{Statamic.component("video_text-fieldtype",I),Statamic.component("video_time-fieldtype",w)});
