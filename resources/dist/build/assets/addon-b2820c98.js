function m(e,t,s,i,a,d,l,h){var n=typeof e=="function"?e.options:e;t&&(n.render=t,n.staticRenderFns=s,n._compiled=!0),i&&(n.functional=!0),d&&(n._scopeId="data-v-"+d);var o;if(l?(o=function(r){r=r||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!r&&typeof __VUE_SSR_CONTEXT__<"u"&&(r=__VUE_SSR_CONTEXT__),a&&a.call(this,r),r&&r._registeredComponents&&r._registeredComponents.add(l)},n._ssrRegister=o):a&&(o=h?function(){a.call(this,(n.functional?this.parent:this).$root.$options.shadowRoot)}:a),o)if(n.functional){n._injectStyles=o;var p=n.render;n.render=function(v,c){return o.call(c),p(v,c)}}else{var u=n.beforeCreate;n.beforeCreate=u?[].concat(u,o):[o]}return{exports:e,options:n}}const f={mixins:[Fieldtype],inject:["storeName"],data(){return{loading:!0,selected:null,items:[]}},computed:{sourceUrl(){return this.store.values[this.config.source]},store(){return this.$store.state.publish[this.storeName]},duration(){return Math.round(this.$refs.video.duration*1e3)},selectedIndex(){return this.items.findIndex(e=>e.id===this.selected)},selectedItem(){return this.items[this.selectedIndex]}},methods:{loadedVideo(){this.loading=!1,this.items=this.value.map(e=>({...e,id:uniqid()})),this.selectItem(this.items[0]),this.syncItems()},addItem(){const e={start:Math.min(this.selectedItem.start+1e3,this.duration),end:null,text:null,id:uniqid()};this.items=[...this.items.slice(0,this.selectedIndex),e,...this.items.slice(this.selectedIndex)],this.syncItems(),this.selectItem(e)},seekVideo(e){this.$refs.video.pause(),this.$refs.video.currentTime=e/1e3},updateItemStart(e){this.updateItem({start:e}),this.seekVideo(e)},updateItem(e){this.items=[...this.items.slice(0,this.selectedIndex),{...this.items[this.selectedIndex],...e},...this.items.slice(this.selectedIndex+1)],this.syncItems()},deleteItem(){this.items=[...this.items.slice(0,this.selectedIndex),...this.items.slice(this.selectedIndex+1)],this.syncItems(),this.selectItem(this.items[0])},selectItem(e){this.selected=e.id},syncItems(){this.items=this.items.sort((e,t)=>e.start-t.start).map((e,t)=>(t===0&&(e={...e,start:0}),t===this.items.length-1?e={...e,end:this.duration}:e={...e,end:this.items[t+1].start},e))},timecode(e){const t=Math.round(e/1e3),s=Math.floor(t/60),i=t%60;return`${s.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`}},watch:{selected(){this.seekVideo(this.selectedItem.start)},items(e){this.updateDebounced(e)}}};var _=function(){var t=this,s=t._self._c;return s("div",[s("video",{ref:"video",staticClass:"video_addon-preview w-full rounded-t bg-black",attrs:{src:t.sourceUrl,controls:""},on:{loadeddata:t.loadedVideo}}),t.loading?t._e():s("div",{staticClass:"flex bg-gray-900 p-2 gap-2 rounded-b -mt-px text-white items-center"},[s("div",{staticClass:"video_addon-track video_text-track"},[s("input",{staticClass:"w-full",attrs:{type:"range",min:0,max:t.duration},domProps:{value:t.selectedItem.start},on:{input:function(i){return t.seekVideo(i.target.value)},change:function(i){return t.updateItemStart(i.target.value)}}}),s("div",{staticClass:"video_text-chapters"},t._l(t.items,function(i){return s("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:i.text||"Unnamed",expression:"item.text || 'Unnamed'"}],style:{"--start":i.start/t.duration,"--end":i.end/t.duration},on:{click:function(a){return t.selectItem(i)}}})}),0)])]),t.loading?t._e():s("div",[t._l(t.items,function(i,a){return s("div",{staticClass:"mt-2 cursor-pointer relative video_text-item",class:{"video_text-selected":i.id===t.selected},on:{click:function(d){return t.selectItem(i)}}},[s("text-input",{staticClass:"w-full",attrs:{prepend:t.timecode(i.start),append:t.timecode(i.end),placeholder:"Text",value:i.text},on:{focus:function(d){return t.selectItem(i)},input:function(d){return t.updateItem({text:d})}}}),a!==0?s("button",{staticClass:"text-gray-600 cursor-pointer px-2 hover:text-blue-500",attrs:{type:"button"},on:{click:function(d){return d.stopPropagation(),t.deleteItem()}}},[s("span",[t._v("Ã—")])]):t._e()],1)}),s("button",{staticClass:"btn mt-2",on:{click:t.addItem}},[t._v("Add Chapter")])],2)])},g=[],I=m(f,_,g,!1,null,null,null,null);const x=I.exports,C={mixins:[Fieldtype],inject:["storeName"],data(){return{loading:!0,item:null}},computed:{sourceUrl(){return this.config.source_url||this.store.values[this.config.source]},store(){return this.$store.state.publish[this.storeName]},duration(){return Math.round(this.$refs.video.duration*1e3)},isSingle(){return this.config.mode==="single"},isRange(){return this.config.mode==="range"}},methods:{loadedVideo(){this.loading=!1,this.item=this.value.start!==null||this.value.end!==null?this.value:{start:0,end:this.duration}},seekVideo(e){this.$refs.video.pause(),this.$refs.video.currentTime=e/1e3},updateTime(e,t){let s;if(this.isRange){const i=e==="start"?0:this.item.start,a=e==="start"?this.item.end:this.duration;s=Math.min(a,Math.max(i,parseInt(t)))}else s=parseInt(t);this.updateItem({[e]:s}),this.seekVideo(s)},updateItem(e){this.item={...this.item,...e},this.updateValue()},updateValue(){this.updateDebounced(this.config.null_limits?{start:this.item.start>0?this.item.start:null,end:this.item.end<this.duration?this.item.end:null}:this.item)},timecode(e){const t=Math.round(e/1e3),s=Math.floor(t/60),i=t%60;return`${s.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`}}};var $=function(){var t=this,s=t._self._c;return s("div",{},[s("video",{ref:"video",staticClass:"video_addon-preview w-full rounded-t bg-black",attrs:{src:t.sourceUrl,controls:""},on:{loadeddata:t.loadedVideo}}),t.loading?t._e():s("div",{staticClass:"flex bg-gray-900 p-2 gap-2 rounded-b -mt-px text-white items-center"},[s("div",{staticClass:"w-12 shrink-0 text-center text-xs"},[t._v(" "+t._s(t.timecode(t.item.start))+" ")]),s("div",{staticClass:"video_addon-track video_time-track"},[s("input",{staticClass:"w-full",attrs:{type:"range",min:0,max:t.duration},domProps:{value:t.item.start},on:{input:function(i){return t.updateTime("start",i.target.value)}}}),t.isRange?s("div",{style:{"--start":t.item.start/t.duration,"--end":t.item.end/t.duration}}):t._e(),t.isRange?s("input",{staticClass:"w-full",attrs:{type:"range",min:0,max:t.duration},domProps:{value:t.item.end},on:{input:function(i){return t.updateTime("end",i.target.value)}}}):t._e()]),t.isRange?s("div",{staticClass:"w-12 shrink-0 text-center text-xs"},[t._v(" "+t._s(t.timecode(t.item.end))+" ")]):t._e()])])},b=[],k=m(C,$,b,!1,null,null,null,null);const y=k.exports;Statamic.booting(()=>{Statamic.component("video_text-fieldtype",x),Statamic.component("video_time-fieldtype",y)});
